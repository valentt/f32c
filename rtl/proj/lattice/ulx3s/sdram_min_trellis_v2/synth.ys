# f32c sdram_min Synthesis Script - GHDL/Yosys compatible
# Uses pipeline.vhd + bptrace + reg1w2r (proper memory inference)
# Uses cache_ghdl.vhd (dual-write-port BRAM fix)
# Uses sdram_controller_ghdl.vhd (separate ports, no VHDL records)
# Expected result: ~3500 LUT4, ~1500 FF (matching Diamond)

ghdl --ieee=synopsys -fexplicit -frelaxed-rules --latches --work=work \
  /projects/f32c/rtl/cpu/defs_mi32.vhd \
  /projects/f32c/rtl/cpu/defs_rv32.vhd \
  /projects/f32c/rtl/cpu/defs_f32c.vhd \
  /projects/f32c/rtl/cpu/idecode_mi32.vhd \
  /projects/f32c/rtl/cpu/idecode_rv32.vhd \
  /projects/f32c/rtl/cpu/debug.vhd \
  /projects/f32c/rtl/cpu/alu.vhd \
  /projects/f32c/rtl/cpu/shift.vhd \
  /projects/f32c/rtl/cpu/loadalign.vhd \
  /projects/f32c/rtl/cpu/mul_dsp.vhd \
  /projects/f32c/rtl/generic/bptrace.vhd \
  /projects/f32c/rtl/generic/reg1w2r.vhd \
  /projects/f32c/rtl/cpu/pipeline.vhd \
  /projects/f32c-valent/rtl/cpu/cache_ghdl.vhd \
  /projects/f32c/rtl/generic/bram_true2p_1clk.vhd \
  /projects/f32c/rtl/generic/bootloader/defs_bootblock.vhd \
  /projects/f32c/rtl/generic/bootloader/boot_sio_rv32el.vhd \
  /projects/f32c/rtl/generic/bootloader/boot_sio_mi32el.vhd \
  /projects/f32c/rtl/generic/bootloader/boot_sio_mi32eb.vhd \
  /projects/f32c/rtl/generic/bootloader/boot_rom_mi32el.vhd \
  ./sdram_controller_ghdl.vhd \
  /projects/f32c/rtl/soc/sio.vhd \
  /projects/f32c/rtl/soc/spi.vhd \
  /projects/f32c/rtl/soc/rtc.vhd \
  /projects/f32c/rtl/generic/rom.vhd \
  ./glue_sdram_min_ghdl.vhd \
  /projects/f32c/rtl/lattice/chip/ecp5u/ecp5pll.vhd \
  /projects/f32c/rtl/lattice/chip/ecp5u/ecp5_flash_clk.vhd \
  ./top_sdram_min.vhd \
  -e top_sdram

# Synthesize for ECP5 - 12F target
synth_ecp5 -top top_sdram -json sdram_min.json
